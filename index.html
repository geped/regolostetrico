<!DOCTYPE html>
<html lang="it" data-theme="light">
<head>
    <meta charset="UTF--8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regolo Ostetrico Interattivo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flatpickr/4.6.13/flatpickr.min.css">
    
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/wheel.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/info-panel.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/modals.css">
    <link rel="stylesheet" href="css/tutorial.css">
    <link rel="stylesheet" href="css/print.css">
</head>
<body class="focus-mode">

    <div id="sidebar-handle">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
        </svg>
    </div>

    <aside id="utility-sidebar">
        <div class="sidebar-content">
            <div id="sidebar-menu">
                <button class="sidebar-menu-btn" data-tool="gest-calculator">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16.2 7.8 20.4 12l-4.2 4.2"/><path d="M8.4 7.8 4.2 12l4.2 4.2"/><path d="M12.6 20.4 9 3.6"/></svg>
                    Calcolatore Gestazionale
                </button>
                <button class="sidebar-menu-btn" data-tool="future-calculator">
                     <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                    Calcolatore Date Future
                </button>
                <button class="sidebar-menu-btn" data-tool="certificate-generator">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                    Genera Attestato
                </button>
            </div>

            <div id="tool-container">
                <div class="tool-panel" id="gest-calculator">
                    <div class="calc-group">
                        <label for="gest-weeks">Settimane</label>
                        <input type="number" id="gest-weeks" min="0" max="42" placeholder="es. 15">
                        <small class="error-msg" id="gest-weeks-error"></small>
                    </div>
                    <div class="calc-group">
                        <label for="gest-days">Giorni</label>
                        <input type="number" id="gest-days" min="0" max="6" placeholder="es. 3">
                        <small class="error-msg" id="gest-days-error"></small>
                    </div>
                    <div class="calc-actions">
                        <button id="calc-gest-btn" class="btn-primary">Calcola</button>
                        <button id="reset-gest-btn" class="btn-secondary">Reset</button>
                    </div>
                    <div id="gest-results" class="results-area">
                        <p>U.M. Stimata: <strong id="um-result">--/--/----</strong></p>
                        <p>D.P.P. Stimata: <strong id="dpp-result">--/--/----</strong></p>
                    </div>
                </div>

                <div class="tool-panel" id="future-calculator">
                    <div class="calc-group">
                        <label for="future-weeks">Aggiungi settimane</label>
                        <input type="number" id="future-weeks" min="0" placeholder="0">
                    </div>
                    <div class="calc-group">
                        <label for="future-days">Aggiungi giorni</label>
                        <input type="number" id="future-days" min="0" placeholder="0">
                    </div>
                     <div class="calc-actions">
                        <button id="reset-future-btn" class="btn-secondary">Reset</button>
                    </div>
                    <div id="future-results" class="results-area">
                        <p>La data calcolata sarÃ :</p>
                        <strong id="future-date-result">--/--/----</strong>
                    </div>
                    <div id="future-calendar" class="calendar-container-sidebar"></div>
                </div>
            </div>
        </div>
    </aside>
    
    <div id="top-left-controls">
        <div id="wheel-joystick-panel">
            <div id="joystick-main-controls">
                <button id="lock-wheel-btn" class="icon-btn" title="Blocca regolo"></button>
                <button id="reset-wheel-btn" class="icon-btn" title="Ripristina Regolo"></button>
                <div id="zoom-container">
                    <button id="zoom-btn" class="icon-btn" title="Zoom"></button>
                    <div id="zoom-popup">
                        <button class="zoom-option-btn active" data-zoom="100">100%</button>
                        <button class="zoom-option-btn" data-zoom="1/3">1/3</button>
                        <button class="zoom-option-btn" data-zoom="1/4">1/4</button>
                    </div>
                </div>
            </div>
            <div id="zoom-controls-container" class="zoom-controls">
                <button id="position-um-btn" class="zoom-control-btn" title="Posiziona UM a 45Â°">
                    <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M16.5885 7.41L6.30849 17.69C5.82849 18.17 5.00849 18.06 4.71849 17.45C4.19849 16.38 3.89849 15.17 3.89849 13.9C3.87849 8.38 9.47849 3.66 11.3785 2.21C11.7485 1.93 12.2485 1.93 12.6085 2.21C13.4785 2.87 15.1085 4.24 16.6385 6.04C16.9785 6.44 16.9585 7.04 16.5885 7.41Z"></path> <path d="M20.1 13.9103C20.1 18.3703 16.47 22.0003 12 22.0003C10.21 22.0003 8.53996 21.4203 7.18996 20.4203C6.69996 20.0603 6.65996 19.3403 7.08996 18.9103L17.16 8.84026C17.63 8.37026 18.42 8.47026 18.74 9.05026C19.56 10.5603 20.11 12.2003 20.1 13.9103Z"></path> </g></svg>
                </button>
                <button id="position-dpp-btn" class="zoom-control-btn" title="Posiziona DPP a 45Â°">
                    <svg version="1.1" id="Uploaded to svgrepo.com" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" xml:space="preserve" fill="currentColor"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M16,5c-0.19,0-0.375,0.017-0.563,0.022l-0.231-0.231C14.994,4.581,14.878,4.299,14.878,4 s0.116-0.581,0.33-0.793c0.436-0.437,1.148-0.437,1.584,0c0.391,0.39,1.023,0.39,1.414,0s0.391-1.024,0-1.415 c-1.217-1.215-3.195-1.214-4.414,0.002C13.202,2.383,12.878,3.167,12.878,4c0,0.428,0.088,0.841,0.251,1.223 C6.219,6.29,1,11.185,1,18c0,7.732,6.716,13,15,13s15-5.268,15-13S24.284,5,16,5z M7.879,17.878c-0.391,0.391-1.023,0.391-1.414,0 c-0.391-0.39-0.391-1.023,0-1.414c1.943-1.943,4.127-1.943,6.07,0c0.391,0.391,0.391,1.024,0,1.414 c-0.195,0.195-0.451,0.293-0.707,0.293s-0.512-0.098-0.707-0.293C9.955,16.712,9.045,16.712,7.879,17.878z M16,29 c-2.761,0-5-1.791-5-4c0-2.209,2.239-4,5-4s5,1.791,5,4C21,27.209,18.761,29,16,29z M25.535,17.878 c-0.195,0.195-0.451,0.293-0.707,0.293s-0.512-0.098-0.707-0.293c-1.166-1.166-2.076-1.166-3.242,0 c-0.391,0.391-1.023,0.391-1.414,0c-0.391-0.39-0.391-1.023,0-1.414c1.943-1.943,4.127-1.943,6.07,0 C25.926,16.855,25.926,17.488,25.535,17.878z M18,25c0,1.105-0.895,2-2,2s-2-0.895-2-2s0.895-2,2-2S18,23.895,18,25z"></path> </g></svg>
                </button>
                </div>
        </div>
    </div>

    <div id="global-controls">
        <button id="toggle-reset-click-btn" class="icon-btn" title="Disabilita reset al click"></button>
        <button id="reset-view-btn" class="icon-btn" title="Resetta vista"></button>
        <button id="show-tutorial-btn" class="icon-btn" title="Mostra tutorial"></button>
        <button id="theme-toggle-btn" class="icon-btn" title="Cambia tema"></button>
    </div>

    <div id="app-container">
        <div class="wheel-container">
            <div id="call-to-action">
                <div class="frosted-glass-cta">
                    <p>Interagisci con il regolo per iniziare</p>
                </div>
            </div>
            <div id="hand-guide-animation">
                <svg fill="#c3889d" width="256px" height="256px" viewBox="0 0 56.00 56.00" xmlns="http://www.w3.org/2000/svg" stroke="#c3889d" stroke-width="1.568"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M 2.8281 35.4883 C 3.6484 35.4648 4.2344 34.8320 4.2578 33.9883 C 4.5157 23.7695 9.7891 16.2227 17.7813 13.2695 L 25.5157 34.5742 C 25.7266 35.1601 25.4922 35.5820 25.1172 35.7227 C 24.7657 35.8398 24.3906 35.7227 23.9453 35.2539 L 17.0547 28.0352 C 15.8594 26.7930 14.3594 26.8633 13.3516 27.7539 C 12.3906 28.5976 12.1094 30.1914 13.3281 31.5976 L 21.5781 41.2070 C 28.4688 49.2461 35.0313 50.6289 42.1094 48.0508 C 51.4141 44.6758 54.6719 36.6367 50.9687 26.4648 L 49.4221 22.2461 C 48.0157 18.3555 45.2970 16.6679 43.1875 17.4414 C 42.7188 17.6055 42.5547 17.9570 42.7188 18.4023 L 43.3984 20.2774 C 43.7266 21.1679 43.4219 21.7774 42.9062 21.9648 C 42.3203 22.1758 41.7110 21.9179 41.3828 21.0274 L 40.9375 19.7852 C 40.1172 17.5117 38.1016 16.5508 36.1328 17.2774 C 35.2422 17.6055 34.9844 18.0976 35.2657 18.8711 L 36.1797 21.4023 C 36.5078 22.2930 36.2266 22.9023 35.6875 23.0898 C 35.1250 23.3008 34.5157 23.0430 34.1875 22.1523 L 33.3203 19.7852 C 32.4062 17.2305 30.4610 16.5742 28.5625 17.2539 C 27.7188 17.5586 27.4141 18.1211 27.6719 18.8476 L 29.5000 23.8633 C 29.8047 24.7539 29.5235 25.3398 28.9844 25.5274 C 28.4219 25.7383 27.8125 25.4805 27.4844 24.5898 L 21.3203 7.6679 C 20.7344 6.0508 19.2813 5.3711 17.8984 5.8633 C 16.4219 6.4023 15.7891 7.8320 16.3984 9.4727 L 16.7266 10.4336 C 7.6562 13.8086 1.3281 22.5742 1.3281 33.9414 C 1.3281 34.7852 2.0313 35.5117 2.8281 35.4883 Z"></path></g></svg>
            </div>
            <svg id="obstetric-wheel" viewBox="0 0 1000 1000"></svg>
            <div id="magnifier-lens" class="magnifier">
                <svg id="magnifier-content"></svg>
            </div>
        </div>

        <div id="info-panel">
            <div id="main-panel">
                <div class="info-item">
                    <span class="info-label">U.M.</span>
                    <div class="hybrid-date-picker">
                        <input type="text" id="um-input" placeholder="GG/MM/AAAA" aria-label="Data Ultima Mestruazione" maxlength="10">
                        <svg class="calendar-icon" id="um-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.75 2a.75.75 0 01.75.75V4h7V2.75a.75.75 0 011.5 0V4h.25A2.75 2.75 0 0118 6.75v8.5A2.75 2.75 0 0115.25 18H4.75A2.75 2.75 0 012 15.25v-8.5A2.75 2.75 0 014.75 4H5V2.75A.75.75 0 015.75 2zm-1 5.5c0-.414.336-.75.75-.75h10.5a.75.75 0 01.75.75v1.25a.75.75 0 01-.75.75H5.5a.75.75 0 01-.75-.75V7.5z" clip-rule="evenodd" /></svg>
                    </div>
                    <div class="datepicker-panel" id="um-datepicker"></div>
                </div>
                <div class="info-item">
                    <span class="info-label">D.P.P.</span>
                     <div class="hybrid-date-picker">
                        <input type="text" id="dpp-input" placeholder="GG/MM/AAAA" aria-label="Data Presunta Parto" maxlength="10">
                        <svg class="calendar-icon" id="dpp-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.75 2a.75.75 0 01.75.75V4h7V2.75a.75.75 0 011.5 0V4h.25A2.75 2.75 0 0118 6.75v8.5A2.75 2.75 0 0115.25 18H4.75A2.75 2.75 0 012 15.25v-8.5A2.75 2.75 0 014.75 4H5V2.75A.75.75 0 015.75 2zm-1 5.5c0-.414.336-.75.75-.75h10.5a.75.75 0 01.75.75v1.25a.75.75 0 01-.75.75H5.5a.75.75 0 01-.75-.75V7.5z" clip-rule="evenodd" /></svg>
                    </div>
                    <div class="datepicker-panel" id="dpp-datepicker"></div>
                </div>

                <button id="toggle-exams-btn">Vedi Esami Programmati</button>
            </div>

            <div id="collapsible-panel">
                <div id="pregnancy-details">
                    <div id="current-week-container">
                        <div id="current-week"></div>
                        <div id="exam-filter-container">
                            <button id="exam-filter-btn" class="icon-btn" title="Filtra Esami">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M2.628 1.601C5.028 1.206 7.49 1 10 1s4.973.206 7.372.601a.75.75 0 01.628.74v2.288a2.25 2.25 0 01-.659 1.59l-4.682 4.683a2.25 2.25 0 00-.659 1.59v3.037c0 .684-.31 1.33-.844 1.757l-1.937 1.55A.75.75 0 018 18.25v-5.757a2.25 2.25 0 00-.659-1.59L2.659 6.22A2.25 2.25 0 012 4.629V2.34a.75.75 0 01.628-.74z" /></svg>
                            </button>
                            <div id="exam-filter-dropdown" class="exam-filter-dropdown">
                                <div class="filter-actions">
                                    <button id="filter-select-all">Seleziona tutti</button>
                                    <button id="filter-deselect-all">Deseleziona tutti</button>
                                </div>
                                <div id="filter-options"></div>
                            </div>
                        </div>
                    </div>
                    <div id="exam-deadlines"></div>
                    <div class="button-group">
                        <button id="print-summary-btn">
                            <span class="btn-text">ðŸ“„ Stampa Riepilogo</span>
                            <span class="btn-spinner" style="display: none;">Generazione...</span>
                        </button>
                        <button id="open-unified-calendar-btn">
                            <span class="btn-text">ðŸ“… Vedi Calendario / Scadenze</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        </div>

    <div id="exam-tooltip"></div>
    <div id="focus-overlay">
        <button id="skip-tutorial-btn">Salta Tutorial</button>
    </div>
    <div id="focus-highlight"></div>
    <div id="focus-tooltip"></div>

    <div class="modal-overlay" id="calendar-modal"></div>
    <div class="modal-overlay" id="certificate-modal"></div>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/it.js"></script>
    
    <script src="js/config.js"></script>
    <script src="js/dateUtils.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/wheel.js"></script>
    <script src="js/calculator.js"></script>
    <script src="js/print.js"></script>
    <script src="js/attestato.js"></script>
    <script src="js/unifiedCalendar.js"></script>

    <script src="js/app.js"></script>
</body>
</html>